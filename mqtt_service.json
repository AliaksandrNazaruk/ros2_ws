{"openapi":"3.1.0","info":{"title":"MQTT Bridge Configuration API","description":"API for managing MQTT broker settings and credentials","version":"1.0.0"},"paths":{"/metrics":{"get":{"tags":["monitoring"],"summary":"Metrics","description":"Prometheus metrics endpoint.","operationId":"metrics_metrics_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/health":{"get":{"tags":["health"],"summary":"Health check endpoint","description":"Returns service health status. Used by Docker healthcheck and monitoring tools.","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Service is healthy","content":{"application/json":{"schema":{},"example":{"status":"healthy","database":"ok","timestamp":"2024-01-01T12:00:00Z"}}}},"503":{"description":"Service is unhealthy"}}}},"/api/v1/":{"get":{"tags":["health","info"],"summary":"Root","description":"Root endpoint with API information.","operationId":"root_api_v1__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/auth/api-keys":{"get":{"tags":["auth"],"summary":"List all API keys","description":"Get list of all API keys (without the actual keys). Requires ADMIN role.","operationId":"list_api_keys_api_v1_auth_api_keys_get","responses":{"200":{"description":"List of API keys","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/APIKeyListItem"},"type":"array","title":"Response List Api Keys Api V1 Auth Api Keys Get"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires ADMIN role)"}},"security":[{"APIKeyHeader":[]}]},"post":{"tags":["auth"],"summary":"Create new API key","description":"Create a new API key with specified role. Returns the key (show only once!).","operationId":"create_api_key_endpoint_api_v1_auth_api_keys_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_create_api_key_endpoint_api_v1_auth_api_keys_post"}}},"required":true},"responses":{"201":{"description":"API key created successfully","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Create Api Key Endpoint Api V1 Auth Api Keys Post"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires ADMIN role)"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/v1/auth/api-keys/{key_id}":{"delete":{"tags":["auth"],"summary":"Revoke API key","description":"Revoke (delete) an API key by key_id. Requires ADMIN role.","operationId":"revoke_api_key_endpoint_api_v1_auth_api_keys__key_id__delete","security":[{"APIKeyHeader":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"string","title":"Key Id"}}],"responses":{"200":{"description":"API key revoked successfully","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Revoke Api Key Endpoint Api V1 Auth Api Keys  Key Id  Delete"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires ADMIN role)"},"404":{"description":"API key not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/config/broker":{"get":{"tags":["config"],"summary":"Get current broker settings","description":"Returns current MQTT broker settings and credentials from database.","operationId":"get_broker_settings_api_v1_config_broker_get","security":[{"APIKeyHeader":[]}],"parameters":[{"name":"include_password","in":"query","required":false,"schema":{"type":"boolean","description":"Include password (admin only)","default":false,"title":"Include Password"},"description":"Include password (admin only)"}],"responses":{"200":{"description":"Current broker settings","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrokerConfigResponse"},"example":{"MQTT_BROKER":"192.168.1.100","MQTT_PORT":1883,"mqtt_user":"admin","mqtt_password":"secret"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"429":{"description":"Too many requests - rate limit exceeded"},"500":{"description":"Configuration retrieval error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["config"],"summary":"Update MQTT broker settings","description":"Updates MQTT broker settings and credentials.\n    \n    Can update all fields simultaneously or only selected ones.\n    All changes are saved to database with change history.\n    \n    **Validation:**\n    - `broker`: must be a valid IP address (IPv4/IPv6) or hostname\n    - `broker_port`: must be in range 1-65535\n    - `mqtt_user`: cannot be empty, maximum 128 bytes\n    - `mqtt_password`: maximum 256 bytes (can be empty)","operationId":"update_broker_settings_api_v1_config_broker_post","security":[{"APIKeyHeader":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrokerConfigUpdate"}}}},"responses":{"200":{"description":"Settings successfully updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrokerConfigResponse"},"example":{"broker":"192.168.1.100","broker_port":1883,"mqtt_user":"admin","mqtt_password":"secret"}}}},"400":{"description":"Input validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"429":{"description":"Too many requests - rate limit exceeded"},"500":{"description":"Database save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/config/certificates/ca":{"get":{"tags":["config"],"summary":"Get MQTT broker CA certificate","description":"Returns the CA certificate for the MQTT broker.\n    \n    This endpoint allows clients to download the CA certificate needed to connect\n    to the MQTT broker via TLS. No authentication required.\n    \n    **Returns:**\n    - CA certificate in PEM format\n    - Content-Type: application/x-pem-file or text/plain\n    \n    **Example:**\n    ```bash\n    curl http://robot-ip:7900/api/v1/config/certificates/ca > mqtt-broker-ca.crt\n    ```","operationId":"get_ca_certificate_api_v1_config_certificates_ca_get","responses":{"200":{"description":"CA certificate in PEM format","content":{"application/json":{"schema":{}},"application/x-pem-file":{},"text/plain":{}}},"404":{"description":"CA certificate not found"}}}},"/api/v1/config/certificates/upload":{"post":{"tags":["config"],"summary":"Upload TLS certificate file","description":"Uploads a single certificate file to the robot via REST API.\n    \n    Supported certificate types:\n    - `ca_cert`: CA certificate (for broker certificate verification)\n    - `client_cert`: Client certificate (for mutual TLS)\n    - `client_key`: Client private key (for mutual TLS)\n    \n    Files are saved to a secure directory and configuration is automatically updated.","operationId":"upload_certificate_api_v1_config_certificates_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_certificate_api_v1_config_certificates_upload_post"}}},"required":true},"responses":{"200":{"description":"Certificate file uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CertificateUploadResponse"}}}},"400":{"description":"Invalid file type or validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"500":{"description":"File save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/v1/config/certificates/upload-multiple":{"post":{"tags":["config"],"summary":"Upload multiple certificate files at once","description":"Uploads multiple certificate files at once.\n    \n    Can upload:\n    - CA certificate\n    - Client certificate\n    - Client key\n    \n    All files are uploaded atomically - either all succeed or rollback.","operationId":"upload_multiple_certificates_api_v1_config_certificates_upload_multiple_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_multiple_certificates_api_v1_config_certificates_upload_multiple_post"}}}},"responses":{"200":{"description":"Certificates uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultipleCertificatesUploadResponse"}}}},"400":{"description":"Invalid file type or validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"500":{"description":"File save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/v1/config/certificates/upload-base64":{"post":{"tags":["config"],"summary":"Upload certificate via base64 (for MQTT)","description":"Uploads certificate via base64-encoded JSON.\n    \n    Useful for uploading via MQTT, where files are transmitted in base64.","operationId":"upload_certificate_base64_api_v1_config_certificates_upload_base64_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CertificateBase64Upload"}}},"required":true},"responses":{"200":{"description":"Certificate uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CertificateUploadResponse"}}}},"400":{"description":"Invalid base64 encoding or validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"500":{"description":"File save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/api/v1/tasks/{task_id}/status":{"get":{"tags":["tasks"],"summary":"Get task status","description":"Get status of a task by task_id.\n    \n    **Note:** This endpoint provides basic task information. For real-time updates,\n    subscribe to MQTT status topics:\n    - `aroc/robot/{robot_id}/status/navigation` - navigation command status\n    - `aroc/robot/{robot_id}/status/system` - system status with active tasks\n    \n    **Task Status Values:**\n    - `running`: Task is currently executing\n    - `completed`: Task completed successfully\n    - `failed`: Task failed with error\n    - `timeout`: Task timed out\n    \n    **MQTT Real-time Tracking:**\n    For real-time task status updates, subscribe to MQTT topics:\n    ```python\n    # Subscribe to navigation status\n    client.subscribe(\"aroc/robot/{robot_id}/status/navigation\")\n    \n    # Subscribe to system status (includes active tasks list)\n    client.subscribe(\"aroc/robot/{robot_id}/status/system\")\n    ```","operationId":"get_task_status_api_v1_tasks__task_id__status_get","security":[{"APIKeyHeader":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Task status retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"404":{"description":"Task not found"},"401":{"description":"Unauthorized - missing or invalid API key"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/tasks":{"get":{"tags":["tasks"],"summary":"List active tasks","description":"Get list of active tasks.\n    \n    **Note:** This endpoint provides basic information. For real-time updates,\n    subscribe to MQTT status topics.","operationId":"list_tasks_api_v1_tasks_get","responses":{"200":{"description":"List of active tasks","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response List Tasks Api V1 Tasks Get"}}}},"401":{"description":"Unauthorized - missing or invalid API key"}},"security":[{"APIKeyHeader":[]}]}},"/health":{"get":{"tags":["health"],"summary":"Health check endpoint","description":"Returns service health status. Used by Docker healthcheck and monitoring tools.","operationId":"health_check_health_get","responses":{"200":{"description":"Service is healthy","content":{"application/json":{"schema":{},"example":{"status":"healthy","database":"ok","timestamp":"2024-01-01T12:00:00Z"}}}},"503":{"description":"Service is unhealthy"}}}},"/":{"get":{"tags":["health","info"],"summary":"Root","description":"Root endpoint with API information.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/auth/api-keys":{"get":{"tags":["auth"],"summary":"List all API keys","description":"Get list of all API keys (without the actual keys). Requires ADMIN role.","operationId":"list_api_keys_auth_api_keys_get","responses":{"200":{"description":"List of API keys","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/APIKeyListItem"},"type":"array","title":"Response List Api Keys Auth Api Keys Get"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires ADMIN role)"}},"security":[{"APIKeyHeader":[]}]},"post":{"tags":["auth"],"summary":"Create new API key","description":"Create a new API key with specified role. Returns the key (show only once!).","operationId":"create_api_key_endpoint_auth_api_keys_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_create_api_key_endpoint_auth_api_keys_post"}}},"required":true},"responses":{"201":{"description":"API key created successfully","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Create Api Key Endpoint Auth Api Keys Post"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires ADMIN role)"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/auth/api-keys/{key_id}":{"delete":{"tags":["auth"],"summary":"Revoke API key","description":"Revoke (delete) an API key by key_id. Requires ADMIN role.","operationId":"revoke_api_key_endpoint_auth_api_keys__key_id__delete","security":[{"APIKeyHeader":[]}],"parameters":[{"name":"key_id","in":"path","required":true,"schema":{"type":"string","title":"Key Id"}}],"responses":{"200":{"description":"API key revoked successfully","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Revoke Api Key Endpoint Auth Api Keys  Key Id  Delete"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires ADMIN role)"},"404":{"description":"API key not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/config/broker":{"get":{"tags":["config"],"summary":"Get current broker settings","description":"Returns current MQTT broker settings and credentials from database.","operationId":"get_broker_settings_config_broker_get","security":[{"APIKeyHeader":[]}],"parameters":[{"name":"include_password","in":"query","required":false,"schema":{"type":"boolean","description":"Include password (admin only)","default":false,"title":"Include Password"},"description":"Include password (admin only)"}],"responses":{"200":{"description":"Current broker settings","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrokerConfigResponse"},"example":{"MQTT_BROKER":"192.168.1.100","MQTT_PORT":1883,"mqtt_user":"admin","mqtt_password":"secret"}}}},"401":{"description":"Unauthorized - missing or invalid API key"},"429":{"description":"Too many requests - rate limit exceeded"},"500":{"description":"Configuration retrieval error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["config"],"summary":"Update MQTT broker settings","description":"Updates MQTT broker settings and credentials.\n    \n    Can update all fields simultaneously or only selected ones.\n    All changes are saved to database with change history.\n    \n    **Validation:**\n    - `broker`: must be a valid IP address (IPv4/IPv6) or hostname\n    - `broker_port`: must be in range 1-65535\n    - `mqtt_user`: cannot be empty, maximum 128 bytes\n    - `mqtt_password`: maximum 256 bytes (can be empty)","operationId":"update_broker_settings_config_broker_post","security":[{"APIKeyHeader":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrokerConfigUpdate"}}}},"responses":{"200":{"description":"Settings successfully updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrokerConfigResponse"},"example":{"broker":"192.168.1.100","broker_port":1883,"mqtt_user":"admin","mqtt_password":"secret"}}}},"400":{"description":"Input validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"429":{"description":"Too many requests - rate limit exceeded"},"500":{"description":"Database save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/config/certificates/ca":{"get":{"tags":["config"],"summary":"Get MQTT broker CA certificate","description":"Returns the CA certificate for the MQTT broker.\n    \n    This endpoint allows clients to download the CA certificate needed to connect\n    to the MQTT broker via TLS. No authentication required.\n    \n    **Returns:**\n    - CA certificate in PEM format\n    - Content-Type: application/x-pem-file or text/plain\n    \n    **Example:**\n    ```bash\n    curl http://robot-ip:7900/api/v1/config/certificates/ca > mqtt-broker-ca.crt\n    ```","operationId":"get_ca_certificate_config_certificates_ca_get","responses":{"200":{"description":"CA certificate in PEM format","content":{"application/json":{"schema":{}},"application/x-pem-file":{},"text/plain":{}}},"404":{"description":"CA certificate not found"}}}},"/config/certificates/upload":{"post":{"tags":["config"],"summary":"Upload TLS certificate file","description":"Uploads a single certificate file to the robot via REST API.\n    \n    Supported certificate types:\n    - `ca_cert`: CA certificate (for broker certificate verification)\n    - `client_cert`: Client certificate (for mutual TLS)\n    - `client_key`: Client private key (for mutual TLS)\n    \n    Files are saved to a secure directory and configuration is automatically updated.","operationId":"upload_certificate_config_certificates_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_certificate_config_certificates_upload_post"}}},"required":true},"responses":{"200":{"description":"Certificate file uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CertificateUploadResponse"}}}},"400":{"description":"Invalid file type or validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"500":{"description":"File save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/config/certificates/upload-multiple":{"post":{"tags":["config"],"summary":"Upload multiple certificate files at once","description":"Uploads multiple certificate files at once.\n    \n    Can upload:\n    - CA certificate\n    - Client certificate\n    - Client key\n    \n    All files are uploaded atomically - either all succeed or rollback.","operationId":"upload_multiple_certificates_config_certificates_upload_multiple_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_multiple_certificates_config_certificates_upload_multiple_post"}}}},"responses":{"200":{"description":"Certificates uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultipleCertificatesUploadResponse"}}}},"400":{"description":"Invalid file type or validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"500":{"description":"File save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/config/certificates/upload-base64":{"post":{"tags":["config"],"summary":"Upload certificate via base64 (for MQTT)","description":"Uploads certificate via base64-encoded JSON.\n    \n    Useful for uploading via MQTT, where files are transmitted in base64.","operationId":"upload_certificate_base64_config_certificates_upload_base64_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CertificateBase64Upload"}}},"required":true},"responses":{"200":{"description":"Certificate uploaded successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CertificateUploadResponse"}}}},"400":{"description":"Invalid base64 encoding or validation error"},"401":{"description":"Unauthorized - missing or invalid API key"},"403":{"description":"Forbidden - insufficient permissions (requires WRITE role)"},"500":{"description":"File save error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyHeader":[]}]}},"/tasks/{task_id}/status":{"get":{"tags":["tasks"],"summary":"Get task status","description":"Get status of a task by task_id.\n    \n    **Note:** This endpoint provides basic task information. For real-time updates,\n    subscribe to MQTT status topics:\n    - `aroc/robot/{robot_id}/status/navigation` - navigation command status\n    - `aroc/robot/{robot_id}/status/system` - system status with active tasks\n    \n    **Task Status Values:**\n    - `running`: Task is currently executing\n    - `completed`: Task completed successfully\n    - `failed`: Task failed with error\n    - `timeout`: Task timed out\n    \n    **MQTT Real-time Tracking:**\n    For real-time task status updates, subscribe to MQTT topics:\n    ```python\n    # Subscribe to navigation status\n    client.subscribe(\"aroc/robot/{robot_id}/status/navigation\")\n    \n    # Subscribe to system status (includes active tasks list)\n    client.subscribe(\"aroc/robot/{robot_id}/status/system\")\n    ```","operationId":"get_task_status_tasks__task_id__status_get","security":[{"APIKeyHeader":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Task status retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatusResponse"}}}},"404":{"description":"Task not found"},"401":{"description":"Unauthorized - missing or invalid API key"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks":{"get":{"tags":["tasks"],"summary":"List active tasks","description":"Get list of active tasks.\n    \n    **Note:** This endpoint provides basic information. For real-time updates,\n    subscribe to MQTT status topics.","operationId":"list_tasks_tasks_get","responses":{"200":{"description":"List of active tasks","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response List Tasks Tasks Get"}}}},"401":{"description":"Unauthorized - missing or invalid API key"}},"security":[{"APIKeyHeader":[]}]}}},"components":{"schemas":{"APIKeyListItem":{"properties":{"key_id":{"type":"string","title":"Key Id"},"role":{"type":"string","title":"Role"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"created_at":{"type":"string","title":"Created At"},"last_used_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Used At"},"revoked":{"type":"boolean","title":"Revoked","default":false},"revoked_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Revoked At"}},"type":"object","required":["key_id","role","created_at"],"title":"APIKeyListItem","description":"API key list item (without the actual key)."},"Body_create_api_key_endpoint_api_v1_auth_api_keys_post":{"properties":{"role":{"$ref":"#/components/schemas/Role","description":"Role for the API key"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Description for the key"}},"type":"object","required":["role"],"title":"Body_create_api_key_endpoint_api_v1_auth_api_keys_post"},"Body_create_api_key_endpoint_auth_api_keys_post":{"properties":{"role":{"$ref":"#/components/schemas/Role","description":"Role for the API key"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Description for the key"}},"type":"object","required":["role"],"title":"Body_create_api_key_endpoint_auth_api_keys_post"},"Body_upload_certificate_api_v1_config_certificates_upload_post":{"properties":{"cert_type":{"type":"string","title":"Cert Type","description":"Certificate type: ca_cert, client_cert, or client_key"},"file":{"type":"string","format":"binary","title":"File","description":"Certificate file"},"auto_update_config":{"type":"boolean","title":"Auto Update Config","description":"Auto-update configuration","default":true}},"type":"object","required":["cert_type","file"],"title":"Body_upload_certificate_api_v1_config_certificates_upload_post"},"Body_upload_certificate_config_certificates_upload_post":{"properties":{"cert_type":{"type":"string","title":"Cert Type","description":"Certificate type: ca_cert, client_cert, or client_key"},"file":{"type":"string","format":"binary","title":"File","description":"Certificate file"},"auto_update_config":{"type":"boolean","title":"Auto Update Config","description":"Auto-update configuration","default":true}},"type":"object","required":["cert_type","file"],"title":"Body_upload_certificate_config_certificates_upload_post"},"Body_upload_multiple_certificates_api_v1_config_certificates_upload_multiple_post":{"properties":{"ca_cert":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"Ca Cert","description":"CA certificate file"},"client_cert":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"Client Cert","description":"Client certificate file"},"client_key":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"Client Key","description":"Client private key file"},"auto_update_config":{"type":"boolean","title":"Auto Update Config","description":"Auto-update configuration","default":true}},"type":"object","title":"Body_upload_multiple_certificates_api_v1_config_certificates_upload_multiple_post"},"Body_upload_multiple_certificates_config_certificates_upload_multiple_post":{"properties":{"ca_cert":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"Ca Cert","description":"CA certificate file"},"client_cert":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"Client Cert","description":"Client certificate file"},"client_key":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"Client Key","description":"Client private key file"},"auto_update_config":{"type":"boolean","title":"Auto Update Config","description":"Auto-update configuration","default":true}},"type":"object","title":"Body_upload_multiple_certificates_config_certificates_upload_multiple_post"},"BrokerConfigResponse":{"properties":{"broker":{"type":"string","title":"Broker","description":"MQTT broker address","examples":["192.168.1.100","broker.example.com"]},"broker_port":{"type":"integer","maximum":65535.0,"minimum":1.0,"title":"Broker Port","description":"MQTT broker port","examples":[1883,8883]},"mqtt_user":{"type":"string","title":"Mqtt User","description":"MQTT username","examples":["admin","user"]},"mqtt_password":{"type":"string","title":"Mqtt Password","description":"MQTT password (hidden in logs)","examples":["********"]},"mqtt_use_tls":{"type":"boolean","title":"Mqtt Use Tls","description":"TLS/SSL encryption enabled","examples":[true,false]},"mqtt_tls_insecure":{"type":"boolean","title":"Mqtt Tls Insecure","description":"Certificate verification disabled (WARNING: only for dev!)","examples":[false]}},"type":"object","required":["broker","broker_port","mqtt_user","mqtt_password","mqtt_use_tls","mqtt_tls_insecure"],"title":"BrokerConfigResponse","description":"Response model with MQTT broker settings.","example":{"MQTT_BROKER":"192.168.1.100","MQTT_PORT":1883,"mqtt_password":"secret","mqtt_tls_insecure":false,"mqtt_use_tls":false,"mqtt_user":"admin"}},"BrokerConfigUpdate":{"properties":{"broker":{"anyOf":[{"type":"string","maxLength":253,"minLength":1},{"type":"null"}],"title":"Broker","description":"MQTT broker address (IP address or hostname)","examples":["192.168.1.100","broker.example.com","localhost"]},"broker_port":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Broker Port","description":"MQTT broker port","examples":[1883,8883,1884]},"mqtt_user":{"anyOf":[{"type":"string","maxLength":128,"minLength":0},{"type":"null"}],"title":"Mqtt User","description":"MQTT authentication username (leave empty for anonymous connection)","examples":["admin","user","mqtt_user",""]},"mqtt_password":{"anyOf":[{"type":"string","maxLength":256,"minLength":0},{"type":"null"}],"title":"Mqtt Password","description":"MQTT authentication password","examples":["password123","secret"]},"mqtt_use_tls":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mqtt Use Tls","description":"Enable TLS/SSL encryption for MQTT connection","examples":[true,false]},"mqtt_tls_insecure":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mqtt Tls Insecure","description":"Disable certificate verification (WARNING: only for dev/testing!)","examples":[false]}},"type":"object","title":"BrokerConfigUpdate","description":"Model for updating MQTT broker configuration.","example":{"MQTT_BROKER":"192.168.1.100","MQTT_PORT":1883,"mqtt_password":"mypassword","mqtt_tls_insecure":false,"mqtt_use_tls":false,"mqtt_user":"myuser"}},"CertificateBase64Upload":{"properties":{"cert_type":{"type":"string","pattern":"^(ca_cert|client_cert|client_key)$","title":"Cert Type","description":"Type of certificate: 'ca_cert', 'client_cert', or 'client_key'"},"content_base64":{"type":"string","title":"Content Base64","description":"Base64-encoded certificate content"},"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Filename","description":"Optional filename (auto-generated if not provided)"},"auto_update_config":{"type":"boolean","title":"Auto Update Config","description":"Automatically update configuration","default":true}},"type":"object","required":["cert_type","content_base64"],"title":"CertificateBase64Upload","description":"Model for uploading certificate via base64 (for MQTT)."},"CertificateUploadResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether upload was successful"},"cert_type":{"type":"string","pattern":"^(ca_cert|client_cert|client_key)$","title":"Cert Type","description":"Type of certificate"},"file_path":{"type":"string","title":"File Path","description":"Path where certificate was saved"},"filename":{"type":"string","title":"Filename","description":"Filename of uploaded certificate"},"auto_updated_config":{"type":"boolean","title":"Auto Updated Config","description":"Whether configuration was automatically updated"},"message":{"type":"string","title":"Message","description":"Human-readable message"}},"type":"object","required":["success","cert_type","file_path","filename","auto_updated_config","message"],"title":"CertificateUploadResponse","description":"Response model for certificate upload."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MultipleCertificatesUploadResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether all uploads were successful"},"uploaded_files":{"additionalProperties":{"type":"string"},"type":"object","title":"Uploaded Files","description":"Dictionary of cert_type -> file_path for uploaded files"},"auto_updated_config":{"type":"boolean","title":"Auto Updated Config","description":"Whether configuration was automatically updated"},"message":{"type":"string","title":"Message","description":"Human-readable message"}},"type":"object","required":["success","uploaded_files","auto_updated_config","message"],"title":"MultipleCertificatesUploadResponse","description":"Response model for multiple certificates upload."},"Role":{"type":"string","enum":["read","write","admin"],"title":"Role","description":"User roles for RBAC."},"TaskStatusResponse":{"properties":{"task_id":{"type":"string","title":"Task Id"},"command_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Command Id"},"service":{"type":"string","title":"Service"},"request_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Request Id"},"status":{"type":"string","title":"Status"},"started_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Started At"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"note":{"type":"string","title":"Note","default":"Task status is tracked via MQTT topics. Use MQTT client to subscribe to status topics for real-time updates."}},"type":"object","required":["task_id","service","status"],"title":"TaskStatusResponse","description":"Response model for task status."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"APIKeyHeader":{"type":"apiKey","in":"header","name":"X-API-Key"}}}}